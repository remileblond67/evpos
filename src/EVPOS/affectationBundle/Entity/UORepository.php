<?php

namespace EVPOS\affectationBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * UORepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class UORepository extends EntityRepository
{
    /**
     * Récupération de la liste des UO
     */
    public function getListeUo() {
        $query = $this->createQueryBuilder('uo')
                ->orderBy('uo.codeUo')
                ->getQuery()
            ;

        return $query->getResult();
    }

    /**
     * Récupération d'une UO à partir de son code
     */
    public function getUo($codeUo) {
        $query = $this->createQueryBuilder('uo')
            ->setParameter('code', $codeUo)
            ->where('uo.codeUo = :code')
            ->getQuery()
        ;

        return $query->getOneOrNullResult();
    }
    
    /**
     * Teste si l'UO dont le code est passé en parametre existe
     */
    public function isUo($codeUo) {
        $nbUo = $this->createQueryBuilder('u')
            ->select('count(u.codeUo)')
            ->setParameter('code', $codeUo)
            ->where('u.codeUo = :code')
            ->getQuery()
            ->getSingleScalarResult()
        ;
        
        if ($nbUo >= 1)
            $retour = true;
        else 
            $retour = false;
            
        return $retour;
    }
}
